{"version":3,"sources":["webpack:///./src/utils/resetForm.js","webpack:///./src/components/user/login.vue","webpack:///./src/components/user/login.vue?4871"],"names":["resetForm","target","reset","obj","Object","keys","map","key","Array","element","undefined","class","_createElementVNode","_createElementBlock","_createVNode","_component_Toast","position","_hoisted_3","onClick","_ctx","push","name","_hoisted_5","_component_InputText","type","$setup","memberForm","account","$event","placeholder","_hoisted_6","password","otp","_toDisplayString","OTP","components","Toast","setup","reload","inject","toast","useToast","store","useStore","router","useRouter","state","reactive","checked","callOtp","onMounted","async","data","callApi","getOtp","res","Data","hanleLogin","login","commit","GoodsName","getGoodsList","catch","add","severity","summary","group","removeLogin","__exports__","render"],"mappings":"kHAAA,kCAAO,MAAMA,EAAaC,IACxB,MAAMC,EAASC,IACbC,OAAOC,KAAKF,GAAKG,IAAKC,IACpB,GAAIJ,EAAII,KAASH,OAAOD,EAAII,IAK1B,OAJAL,EAAMC,EAAII,SACNJ,EAAII,aAAgBC,QACtBL,EAAII,GAAO,KAGR,CAEL,MAAME,EAAUN,EAAII,GACpB,cAAeE,GACb,IAAK,SACHN,EAAII,GAAO,GACX,MACF,IAAK,SACHJ,EAAII,GAAO,EACX,MACF,IAAK,SACHJ,EAAII,GAAOE,aAAmBD,MAAQ,GAAK,GAC3C,MACF,IAAK,UACHL,EAAII,IAAO,EACX,MACF,QACEJ,EAAII,QAAOG,EACX,WAKVR,EAAMD,K,kEC/BDU,MAAM,S,GAEJA,MAAM,gB,EACTC,eAAiB,YAAX,QAAI,G,GAGPD,MAAM,c,EACTC,eAAS,SAAN,MAAE,G,EAELA,eAAS,SAAN,MAAE,G,GAEAD,MAAM,O,GAINA,MAAM,U,8GAffE,eAmBM,MAnBN,EAmBM,CAlBJC,eAA2BC,EAAA,CAApBC,SAAS,WAChBJ,eAGM,MAHN,EAGM,CAFJK,EACAL,eAAuD,KAAnDM,QAAK,eAAEC,UAAQC,KAAI,CAAAC,oBAAwB,UAEjDT,eAYM,MAZN,EAYM,CAXJU,EACAR,eAAkFS,EAAA,CAAvEC,KAAK,O,WAAgBC,QAAMC,WAAWC,Q,qCAAjBF,QAAMC,WAAWC,QAAOC,GAAEC,YAAY,WAAtE,uBACAC,EACAhB,eAAuFS,EAAA,CAA5EC,KAAK,W,WAAoBC,QAAMC,WAAWK,S,qCAAjBN,QAAMC,WAAWK,SAAQH,GAAEC,YAAY,WAA3E,uBACAjB,eAGM,MAHN,EAGM,CAFJE,eAAwDS,EAAA,CAA7CC,KAAK,O,WAAgBC,QAAMC,WAAWM,I,qCAAjBP,QAAMC,WAAWM,IAAGJ,IAApD,uBACAhB,eAA0B,YAAAqB,eAAjBR,MAAIS,KAAG,KAElBtB,eAEM,MAFN,EAEM,CADJA,eAA8D,UAAtDD,MAAM,iBAAkBO,QAAK,oBAAEO,mCAAY,Y,wFAe5C,GACbJ,KAAM,QACNc,WAAY,CACVC,cAEFC,QACE,MAAMC,EAASC,eAAO,UAChBC,EAAQC,iBACRC,EAAQC,iBACRC,EAASC,iBACTC,EAAQC,eAAS,CACrBrB,WAAY,CACVC,QAAS,GACTI,SAAU,GACVC,IAAK,IAEPgB,SAAS,IAEX,IAAIhB,EAAMe,eAAS,CAAEb,IAAK,KAE1B,MAAMe,EAAUC,eAAUC,UACxB,MAAMC,EAAO,SACPC,eAAQC,OAAQF,EAAOG,IAC3BvB,EAAIE,IAAMqB,EAAIH,KAAKI,KAAKtB,QAItBuB,EAAaN,UACbL,EAAMpB,WAAWC,SAAWmB,EAAMpB,WAAWK,UAAYe,EAAMpB,WAAWM,UACtEqB,eAAQK,OAAOZ,EAAMpB,WAAYyB,UACrCT,EAAMiB,OAAO,+BAAgCJ,EAAIH,KAAKI,MACtD,MAAMJ,EAAO,CAAEQ,UAAW,UACpBP,eAAQQ,OAAcT,EAAOG,IACjCb,EAAMiB,OAAO,8BAA+BJ,EAAIH,KAAKI,cAEjDZ,EAAOxB,KAAK,CAAEC,KAAM,iBACpBiB,MACLwB,MAAM,KACPtB,EAAMuB,IAAI,CAAEC,SAAU,QAASC,QAAS,cAAeC,MAAO,aAC9DC,IACAlB,OAGFT,EAAMuB,IAAI,CAAEC,SAAU,QAASC,QAAS,UAAWC,MAAO,aAC1DC,IACAlB,MAIEkB,EAAc,KAClBnE,eAAU8C,EAAMpB,aAElB,MAAO,CACLoB,QACAd,MACAiB,UACAQ,aACAU,iB,qBCpFN,MAAMC,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,KAErD","file":"js/chunk-28de1d34.75b56ed9.js","sourcesContent":["export const resetForm = (target) => {\n  const reset = (obj) => {\n    Object.keys(obj).map((key) => {\n      if (obj[key] === Object(obj[key])) {\n        reset(obj[key])\n        if (obj[key] instanceof Array) {\n          obj[key] = []\n        }\n        return\n      } else {\n        // 保留型別\n        const element = obj[key]\n        switch (typeof element) {\n          case 'string':\n            obj[key] = ''\n            break\n          case 'number':\n            obj[key] = 0\n            break\n          case 'object':\n            obj[key] = element instanceof Array ? [] : {}\n            break\n          case 'boolean':\n            obj[key] = false\n            break\n          default:\n            obj[key] = undefined\n            break\n        }\n      }\n    })\n  }\n  reset(target)\n}\n","<template>\n  <div class=\"login\">\n    <Toast position=\"center\" />\n    <div class=\"login-button\">\n      <span>會員登入</span>\n      <p @click=\"$router.push({ name: 'Register' })\">註冊會員</p>\n    </div>\n    <div class=\"login-data\">\n      <p>帳號</p>\n      <InputText type=\"text\" v-model=\"state.memberForm.account\" placeholder=\"請輸入您的帳號\" />\n      <p>密碼</p>\n      <InputText type=\"password\" v-model=\"state.memberForm.password\" placeholder=\"請輸入您的密碼\" />\n      <div class=\"otp\">\n        <InputText type=\"text\" v-model=\"state.memberForm.otp\" />\n        <span>{{ otp.OTP }}</span>\n      </div>\n      <div class=\"submit\">\n        <button class=\"button_confirm\" @click=\"hanleLogin\">登入</button>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport Toast from 'primevue/toast'\nimport { reactive, onMounted, inject } from 'vue'\nimport { getOtp, login, getGoodsList } from '@/service/api'\nimport { callApi } from '@/utils/callApi'\nimport { useRouter } from 'vue-router'\nimport { resetForm } from '@/utils/resetForm'\nimport { useToast } from 'primevue/usetoast'\nimport { useStore } from 'vuex'\n\nexport default {\n  name: 'Login',\n  components: {\n    Toast\n  },\n  setup() {\n    const reload = inject('reload')\n    const toast = useToast()\n    const store = useStore()\n    const router = useRouter()\n    const state = reactive({\n      memberForm: {\n        account: '',\n        password: '',\n        otp: ''\n      },\n      checked: false\n    })\n    let otp = reactive({ OTP: '' })\n    //取得otp\n    const callOtp = onMounted(async () => {\n      const data = ''\n      await callApi(getOtp, data, (res) => {\n        otp.OTP = res.data.Data.OTP\n      })\n    })\n    //登入會員\n    const hanleLogin = async () => {\n      if (state.memberForm.account && state.memberForm.password && state.memberForm.otp) {\n        await callApi(login, state.memberForm, async (res) => {\n          store.commit('memberModules/SET_USERSTATUS', res.data.Data)\n          const data = { GoodsName: '' }\n          await callApi(getGoodsList, data, (res) => {\n            store.commit('goodsModules/SET_GOODSTATUS', res.data.Data)\n          })\n          await router.push({ name: 'Member' })\n          await reload()\n        }).catch(() => {\n          toast.add({ severity: 'error', summary: '輸入錯入，請重新輸入！', group: 'errorBox' })\n          removeLogin()\n          callOtp()\n        })\n      } else {\n        toast.add({ severity: 'error', summary: '欄位不可為空！', group: 'errorBox' })\n        removeLogin()\n        callOtp()\n      }\n    }\n    // 清除欄位\n    const removeLogin = () => {\n      resetForm(state.memberForm)\n    }\n    return {\n      state,\n      otp,\n      callOtp,\n      hanleLogin,\n      removeLogin\n    }\n  }\n}\n</script>\n","import { render } from \"./login.vue?vue&type=template&id=34d4b5e4\"\nimport script from \"./login.vue?vue&type=script&lang=js\"\nexport * from \"./login.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/risu_ann/Documents/web/dessert_work/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}